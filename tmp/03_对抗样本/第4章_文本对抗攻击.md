# 第4章：文本对抗攻击

## 本章导读

在前面的章节中，我们学习了针对图像分类模型的对抗攻击技术。然而，当攻击目标从图像转向文本时，情况变得更加复杂。文本是由离散的字符和词语组成的，无法像图像那样进行连续的微小调整。本章将探讨文本对抗攻击的独特挑战，介绍字符级、词级和句级三种攻击层次，帮助我们理解如何在保持语义不变的前提下欺骗自然语言处理模型。掌握这些知识，对于理解和防御针对文本系统的攻击至关重要。

## 章节目标

学完本章后，你将能够：

- 理解文本对抗攻击与图像对抗攻击的本质区别，解释为什么文本攻击更具挑战性
- 掌握字符级攻击的常见手法，如字符替换、插入和删除
- 理解词级攻击的核心思想，包括重要词识别和同义词替换策略
- 了解句级攻击的基本方法，如回译技术和句式变换
- 能够分析不同攻击层次的优缺点，判断其适用场景

---

## 1. 文本对抗攻击的独特挑战

### 1.1 从连续到离散：文本与图像的本质差异

在学习文本对抗攻击之前，我们需要先理解一个关键问题：为什么针对文本的攻击比针对图像的攻击更加困难？

回顾前面学习的图像对抗攻击，我们知道图像是由像素组成的，每个像素的值是一个连续的数值（例如 0 到 255 之间的整数，或者归一化后 0 到 1 之间的浮点数）。这意味着我们可以对像素值进行任意微小的调整，比如将某个像素从 0.5 改为 0.5001。这种微小的变化人眼几乎无法察觉，但却可能导致模型的判断发生改变。

然而，文本的情况完全不同。文本是由离散的符号组成的——字符、词语、句子。我们无法将字母"a"改成"a 加一点点"，要么是"a"，要么是"b"，不存在中间状态。这种**离散性（Discreteness）**是文本对抗攻击面临的核心挑战。

用一个生活中的类比来理解：图像攻击就像调节音量旋钮，可以无级调节，从 50% 调到 50.1%；而文本攻击则像按电梯按钮，只能选择具体的楼层，无法选择"3.5 楼"。

### 1.2 语义保持：攻击的隐蔽性约束

文本对抗攻击还面临另一个重要约束：**语义保持（Semantic Preservation）**。

在图像攻击中，我们通过限制扰动的大小（如 L∞ 范数小于某个阈值）来确保修改后的图像在视觉上与原图相似。但在文本中，"相似"的定义变得模糊。考虑以下两个句子：

- 原句："这部电影非常精彩"
- 修改后："这部电影非常出色"

虽然只替换了一个词，但两个句子表达的意思几乎相同。这种修改是可以接受的。但如果改成：

- 修改后："这部电影非常糟糕"

虽然也只改了一个词，但意思完全相反，这种修改就不符合对抗攻击的要求。

因此，文本对抗攻击必须在两个目标之间取得平衡：一方面要让模型产生错误判断，另一方面要保持文本的原始语义，让人类读者仍然能够理解原本的意思。

### 1.3 三种攻击层次概览

根据修改文本的粒度不同，文本对抗攻击可以分为三个层次：

| 攻击层次 | 修改对象 | 典型方法 | 特点 |
|---------|---------|---------|------|
| 字符级 | 单个字符 | 替换、插入、删除、交换 | 简单直接，但容易被检测 |
| 词级 | 单个词语 | 同义词替换、词语插入 | 语义保持较好，效果稳定 |
| 句级 | 整个句子 | 回译、句式变换 | 修改幅度大，语义可能偏移 |

接下来，我们将逐一深入探讨这三种攻击层次的原理和方法。

---

## 2. 字符级攻击：最直接的扰动方式

### 2.1 字符级攻击的基本思想

字符级攻击是最直观的文本对抗方法。它的核心思想是：通过对文本中的个别字符进行微小修改，使模型产生错误判断，同时人类读者仍然能够理解原文的意思。

这种攻击方式利用了一个有趣的现象：人类阅读时具有很强的容错能力。即使文本中存在一些拼写错误，我们通常仍然能够理解其含义。例如，看到"计算机科学"被写成"计算机科鸳"，大多数人仍然能够理解这是在说"计算机科学"。但对于机器学习模型来说，这种字符的变化可能导致完全不同的理解。

### 2.2 常见的字符级攻击手法

字符级攻击主要包括以下几种操作：

**字符替换（Character Substitution）**

将文本中的某个字符替换为另一个视觉上相似或发音相似的字符。常见的替换策略包括：

- 形近字替换：将"银行"改为"银彳亍"（利用生僻字）
- 同音字替换：将"账户"改为"帐户"
- 视觉相似替换：将英文字母"o"替换为数字"0"，将"l"替换为"1"

**字符插入（Character Insertion）**

在词语中插入额外的字符，打断模型对词语的识别。例如：

- 在"恶意软件"中插入空格变成"恶 意 软 件"
- 在英文单词中插入不可见字符

**字符删除（Character Deletion）**

删除词语中的某个字符。例如将"病毒"改为"病"或"毒"。

**字符交换（Character Swap）**

交换相邻字符的位置。例如将"网络"改为"络网"。

### 2.3 字符级攻击的局限性

虽然字符级攻击实现简单，但它存在明显的局限性：

首先，这类攻击容易被检测。许多系统会在处理文本之前进行拼写检查或文本规范化，将异常字符还原为正常形式。

其次，过多的字符修改会严重影响可读性。如果一段文本中充满了错别字和异常字符，人类读者也会感到困惑，这就违背了对抗攻击"保持隐蔽"的原则。

最后，字符级攻击对于基于字符的模型（如某些中文处理模型）效果有限，因为这些模型本身就是在字符级别进行处理的。

了解了字符级攻击的原理和局限后，我们来看一种更加精细的攻击方式——词级攻击。

---

## 3. 词级攻击：同义词替换的艺术

### 3.1 词级攻击的核心思想

词级攻击是目前研究最多、效果最稳定的文本对抗攻击方法。它的核心思想可以用一句话概括：**找到对模型判断影响最大的词，用意思相近的词替换它**。

这个思想背后有一个重要的观察：在一段文本中，并非所有词语对模型的判断都同等重要。有些词是"关键词"，它们的存在或改变会显著影响模型的输出；而另一些词则相对"无关紧要"，即使被替换也不会产生太大影响。

举个例子，对于情感分类任务，句子"这部电影非常精彩，演员表演出色"中，"精彩"和"出色"这样的情感词显然比"这部"、"电影"这样的中性词更加重要。

### 3.2 重要词识别：找到攻击的突破口

词级攻击的第一步是识别哪些词对模型的判断最重要。常用的方法包括：

**删除法（Leave-One-Out）**

这是最直观的方法：依次删除句子中的每个词，观察模型输出的变化。如果删除某个词后模型的置信度下降明显，说明这个词很重要。

例如，对于句子"这家餐厅的服务态度很差"：
- 删除"这家"：模型置信度变化 2%
- 删除"餐厅"：模型置信度变化 5%
- 删除"服务态度"：模型置信度变化 15%
- 删除"很差"：模型置信度变化 40%

通过这种方式，我们可以确定"很差"是最重要的词，应该优先考虑替换。

**梯度法（Gradient-based）**

如果能够访问模型的内部结构（白盒场景），可以计算每个词的词向量对输出的梯度。梯度越大，说明该词对输出的影响越大。这种方法比删除法更高效，但需要模型的内部访问权限。

### 3.3 同义词替换：保持语义的关键

找到重要词后，下一步是用同义词替换它。这里的挑战在于：如何找到既能改变模型判断，又能保持原始语义的替换词？

**同义词来源**

常用的同义词来源包括：
- 同义词词典（如中文的《同义词词林》）
- 词向量空间中的近邻词（如 Word2Vec 中距离最近的词）
- 预训练语言模型生成的候选词

**替换词筛选**

并非所有同义词都适合作为替换词。需要考虑以下因素：

1. **语义相似度**：替换词与原词的语义距离不能太远
2. **语法正确性**：替换后的句子必须语法通顺
3. **攻击效果**：替换后能够改变模型的判断

实际操作中，通常会生成多个候选替换词，然后逐一测试，选择效果最好的那个。

### 3.4 词级攻击的实际案例

**案例：垃圾邮件过滤器绕过（2018年）**

背景：研究人员发现，许多垃圾邮件过滤器依赖于关键词检测。如果邮件中包含"免费"、"中奖"、"优惠"等词语，就会被标记为垃圾邮件。

攻击过程：攻击者使用词级对抗攻击技术，将垃圾邮件中的敏感词替换为同义词或近义词。例如：
- "免费领取" → "无偿获得"
- "中奖通知" → "获奖提醒"
- "限时优惠" → "限期特价"

影响与后果：经过这种处理的垃圾邮件成功绕过了多个主流邮件服务商的过滤系统，导致大量用户收到垃圾邮件。

启示：这个案例说明，基于关键词的文本分类系统非常脆弱。防御方需要采用更加鲁棒的语义理解方法，而不是简单地依赖关键词匹配。

词级攻击虽然效果稳定，但修改粒度仍然有限。接下来我们来看修改幅度更大的句级攻击。

---

## 4. 句级攻击：整体改写的策略

### 4.1 句级攻击的基本思想

句级攻击不再局限于修改个别字符或词语，而是对整个句子进行改写。它的目标是：在保持句子核心语义的前提下，生成一个表述方式完全不同的新句子，从而欺骗模型。

这种攻击方式的优势在于：由于整个句子都被改写，模型很难通过简单的规则来检测和防御。但同时，它也面临更大的挑战：如何确保改写后的句子仍然表达原来的意思？

### 4.2 回译攻击：借助机器翻译的力量

**回译（Back-Translation）**是句级攻击中最常用的技术。它的原理非常巧妙：

1. 将原始句子翻译成另一种语言（如英语翻译成中文）
2. 再将翻译结果翻译回原来的语言（中文翻译回英语）

由于机器翻译并不完美，回译后的句子通常会与原句有所不同，但核心语义基本保持不变。

例如，原句"The movie was absolutely fantastic"经过英语→中文→英语的回译后，可能变成"This film was really wonderful"。两个句子表达的意思相同，但用词和句式都发生了变化。

回译攻击的优点是操作简单，只需要调用现成的机器翻译 API 即可。缺点是翻译质量不稳定，有时会产生语义偏移或语法错误。

### 4.3 句式变换：主动改写句子结构

除了回译，还可以通过主动改写句子结构来实现句级攻击。常见的句式变换包括：

**主动语态与被动语态转换**
- 原句："研究人员发现了这个漏洞"
- 改写："这个漏洞被研究人员发现了"

**肯定句与双重否定句转换**
- 原句："这个方法很有效"
- 改写："这个方法并非没有效果"

**简单句与复合句转换**
- 原句："他很聪明。他很勤奋。"
- 改写："他不仅聪明，而且勤奋。"

这些变换保持了句子的核心语义，但改变了句子的结构和用词，可能导致模型产生不同的判断。

### 4.4 句级攻击的挑战与局限

句级攻击面临的最大挑战是**语义漂移（Semantic Drift）**。由于改写幅度较大，很难保证改写后的句子与原句表达完全相同的意思。特别是对于包含细微情感或复杂逻辑的句子，句级改写很容易导致语义偏移。

此外，句级攻击的计算成本通常较高。无论是回译还是句式变换，都需要调用额外的模型或工具，这在实际攻击场景中可能成为限制因素。

---

## 5. 本章小结

本章系统介绍了文本对抗攻击的原理和方法。我们首先分析了文本对抗攻击面临的独特挑战——离散性和语义保持约束，这使得文本攻击比图像攻击更加困难。

随后，我们按照攻击粒度从小到大，依次介绍了三种攻击层次：

- **字符级攻击**：通过替换、插入、删除或交换字符来扰动文本，实现简单但容易被检测
- **词级攻击**：通过识别重要词并用同义词替换，是目前最主流的文本对抗攻击方法
- **句级攻击**：通过回译或句式变换对整个句子进行改写，修改幅度大但语义保持困难

每种攻击方法都有其适用场景和局限性。在实际应用中，攻击者往往会结合多种方法，根据具体情况选择最合适的策略。

理解这些攻击技术，对于构建更加鲁棒的自然语言处理系统具有重要意义。在下一章中，我们将学习如何防御这些对抗攻击。

---

## 教学资源

### 图表与示意图

- 【图 4-1】文本对抗攻击三层次对比图：展示字符级、词级、句级攻击的修改粒度和效果差异
- 【图 4-2】词级攻击流程图：重要词识别 → 同义词生成 → 替换词筛选 → 攻击验证
- 【图 4-3】回译攻击示意图：原文 → 翻译 → 回译 → 对抗样本

### 配套实验

本章内容对应实验 3.4：文本对抗攻击实验。在实验中，你将：
- 使用删除法识别句子中的重要词
- 实现基于同义词替换的词级攻击
- 观察攻击前后模型输出的变化

### 延伸阅读

- TextFooler：一种经典的词级文本对抗攻击方法
- BERT-Attack：利用预训练语言模型生成对抗样本
- 文本对抗攻击综述论文

---

## 课后思考题

1. **理解性问题**：为什么说文本的离散性是文本对抗攻击面临的核心挑战？请用自己的话解释，并举例说明。

2. **分析性问题**：在词级攻击中，为什么需要先识别"重要词"再进行替换？如果随机选择词语进行替换，会有什么问题？

3. **应用性问题**：假设你需要设计一个能够抵御文本对抗攻击的情感分类系统，你会采取哪些防御措施？请至少列出三种可能的方法。

---

## 术语对照表

| 中文术语 | 英文术语 | 简要解释 |
|---------|---------|---------|
| 离散性 | Discreteness | 文本由不可连续变化的符号组成的特性 |
| 语义保持 | Semantic Preservation | 修改文本时保持原始含义不变的约束 |
| 字符替换 | Character Substitution | 将文本中的字符替换为其他字符 |
| 同义词替换 | Synonym Substitution | 用意思相近的词替换原词 |
| 回译 | Back-Translation | 将文本翻译成另一种语言后再翻译回来 |
| 语义漂移 | Semantic Drift | 文本改写过程中语义发生偏移的现象 |
| 重要词 | Important Word | 对模型判断影响较大的词语 |
